{% extends "admin/base_site.html" %}
{% load humanize %}

{% block content %}
<h1>ğŸ“Š THá»NG KÃŠ Há»† THá»NG</h1>
<hr>

<!-- ================= Tá»”NG QUAN ================= -->
<h2>ğŸ” Tá»•ng quan</h2>
<div class="stat-wrap">
    <div class="stat">ğŸ“„ Tin tuyá»ƒn dá»¥ng<br><b>{{ tong_tin }}</b></div>
    <div class="stat">ğŸ¢ NhÃ  tuyá»ƒn dá»¥ng<br><b>{{ tong_ntd }}</b></div>
    <div class="stat">ğŸ‘¤ á»¨ng viÃªn<br><b>{{ tong_uv }}</b></div>
    <div class="stat">ğŸ“‘ Há»“ sÆ¡ á»©ng tuyá»ƒn<br><b>{{ tong_hoso }}</b></div>
    <div class="stat">ğŸ’° Doanh thu<br><b>{{ tong_doanh_thu|intcomma }} VNÄ</b></div>
</div>

<hr>

<!-- ================= BIá»‚U Äá»’ ================= -->
<h2>ğŸ“ˆ Tin tuyá»ƒn dá»¥ng theo thÃ¡ng ({{ now|date:"Y" }})</h2>
<canvas id="tinTheoThang"></canvas>

<hr>

<h2>ğŸ§¾ Há»“ sÆ¡ á»©ng tuyá»ƒn theo thÃ¡ng</h2>
<canvas id="hosoTheoThang"></canvas>

<hr>

<h2>ğŸ† Top nhÃ  tuyá»ƒn dá»¥ng</h2>
<canvas id="topNTD"></canvas>

<hr>

<h2>ğŸ”¥ Top ngÃ nh nghá»</h2>
<canvas id="topNganh"></canvas>

<!-- ================= CHART JS ================= -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
/* ====== Tin theo thÃ¡ng ====== */
const tinLabels = [{% for i in tin_theo_thang %}'ThÃ¡ng {{ i.ngay_dang__month }}',{% endfor %}];
const tinData = [{% for i in tin_theo_thang %}{{ i.total }},{% endfor %}];

new Chart(document.getElementById('tinTheoThang'), {
    type: 'bar',
    data: {
        labels: tinLabels,
        datasets: [{
            label: 'Sá»‘ tin tuyá»ƒn dá»¥ng',
            data: tinData,
            backgroundColor: '#4CAF50'
        }]
    }
});

/* ====== Há»“ sÆ¡ theo thÃ¡ng ====== */
const hsLabels = [{% for i in ho_so_theo_thang %}'ThÃ¡ng {{ i.ngay_nop__month }}',{% endfor %}];
const hsData = [{% for i in ho_so_theo_thang %}{{ i.total }},{% endfor %}];

new Chart(document.getElementById('hosoTheoThang'), {
    type: 'bar',
    data: {
        labels: hsLabels,
        datasets: [{
            label: 'Sá»‘ há»“ sÆ¡ á»©ng tuyá»ƒn',
            data: hsData,
            backgroundColor: '#2196F3'
        }]
    }
});

/* ====== Top nhÃ  tuyá»ƒn dá»¥ng ====== */
new Chart(document.getElementById('topNTD'), {
    type: 'pie',
    data: {
        labels: [{% for i in top_ntd %}'{{ i.nha_tuyen_dung__ten_cong_ty }}',{% endfor %}],
        datasets: [{
            data: [{% for i in top_ntd %}{{ i.total }},{% endfor %}],
        }]
    }
});

/* ====== Top ngÃ nh nghá» ====== */
new Chart(document.getElementById('topNganh'), {
    type: 'pie',
    data: {
        labels: [{% for i in top_nganh %}'{{ i.nganh_nghe__ten }}',{% endfor %}],
        datasets: [{
            data: [{% for i in top_nganh %}{{ i.total }},{% endfor %}],
        }]
    }
});
</script>

<style>
.stat-wrap {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
}
.stat {
    padding: 16px 24px;
    background: #f5f5f5;
    border-radius: 10px;
    font-size: 16px;
    min-width: 200px;
    text-align: center;
}
canvas {
    max-width: 800px;
    margin: 20px 0;
}
</style>

{% endblock %}
